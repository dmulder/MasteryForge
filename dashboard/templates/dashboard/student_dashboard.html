{% extends "base.html" %}

{% block title %}Student Dashboard - MasteryForge{% endblock %}

{% block content %}
<div class="card">
    <h2>My Learning Dashboard</h2>
    
    <div class="stat-grid">
        <div class="stat-card">
            <h3>{{ mastered_count }}</h3>
            <p>Concepts Mastered</p>
        </div>
        <div class="stat-card">
            <h3>{{ total_concepts }}</h3>
            <p>Total Concepts</p>
        </div>
        <div class="stat-card">
            <h3>{{ progress_percentage|floatformat:0 }}%</h3>
            <p>Overall Progress</p>
        </div>
    </div>
    
    <div style="display:flex; align-items:center; justify-content: space-between; gap: 1rem; margin-top: 1.5rem;">
        <h3>Overall Progress</h3>
        <a href="{% url 'learning_session' %}" class="btn">Continue Learning</a>
    </div>
    <div class="progress-bar">
        <div class="progress-bar-fill" style="width: {{ progress_percentage }}%;">
            {{ progress_percentage|floatformat:0 }}%
        </div>
    </div>
</div>

{% if next_concept %}
<div class="card">
    <h2>ðŸŽ¯ Recommended Next Concept</h2>
    <p style="margin: 1rem 0; font-size: 1.1rem;">
        Ready to continue? We'll guide you straight into the next lesson.
    </p>
    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 6px; border-left: 4px solid #3498db;">
        <h3 style="color: #2c3e50; margin-bottom: 0.5rem;">{{ next_concept.title }}</h3>
        <a href="{% url 'learning_session' %}" class="btn" style="margin-top: 1rem;">Start Learning</a>
    </div>
</div>
{% endif %}

{% if mastery_states %}
<div class="card">
    <h2>ðŸ“Š Recent Activity</h2>
    <table>
        <thead>
            <tr>
                <th>Concept</th>
                <th>Mastery Score</th>
                <th>Frustration</th>
                <th>Attempts</th>
                <th>Last Attempted</th>
            </tr>
        </thead>
        <tbody>
            {% for state in mastery_states %}
            <tr>
                <td>
                    <a href="{% url 'concept_detail' state.concept.id %}" style="color: #3498db; text-decoration: none;">
                        {{ state.concept.title }}
                    </a>
                </td>
                <td>
                    <span style="color: {% if state.mastery_score >= 0.7 %}#27ae60{% elif state.mastery_score >= 0.4 %}#f39c12{% else %}#e74c3c{% endif %};">
                        {{ state.mastery_score|floatformat:2 }}
                    </span>
                </td>
                <td>
                    <span style="color: {% if state.frustration_score >= 0.7 %}#e74c3c{% elif state.frustration_score >= 0.4 %}#f39c12{% else %}#27ae60{% endif %};">
                        {{ state.frustration_score|floatformat:2 }}
                    </span>
                </td>
                <td>{{ state.attempts }}</td>
                <td>{{ state.last_seen|date:"M d, Y H:i" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="card">
    <h2>ðŸš€ Get Started!</h2>
    <p style="margin: 1rem 0;">
        You haven't started any concepts yet. Begin your learning journey by exploring the available concepts above!
    </p>
</div>
{% endif %}
{% endblock %}
